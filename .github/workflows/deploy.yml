 name: Production Deployment
 on:
   push:
     branches: [main]
 jobs:
    build:
      runs-on: ubuntu-20.04
      steps:
        - uses: actions/checkout@v2
        - name: Install and setup Node version
          uses: actions/setup-node@v2
          with:
            node-version: '14.19.1'
            cache: 'npm'
        - name: Setup the AWS Cli
          uses: aws-actions/configure-aws-credentials@v1
          with:
            aws-region: "eu-central-1"
            aws-access-key-id: "AKIAVC36JNS35OB4CUFL"
            aws-secret-access-key: "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"
        - run: npm ci
        - run: NODE_ENV=production npm run build --if-present
        - run: aws s3 sync . s3:// --quiet --delete
